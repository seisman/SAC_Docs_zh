\SACCMD{readcss}
\label{cmd:readcss}

\SACTitle{概要}
从磁盘读取CSS文件到内存

注意：READCSS命令读取CSS 3.0或2.0的文本文件。
3.0版本支持如下数据库表：

wfdisc、wftag、origin、arrival、assoc、sitechan、site、affiliation、origerr、origin、event、sensor、instrument、gregion、
stassoc和remark sacdata。

\SACTitle{语法}
\begin{SACSTX}
READCSS [BINARY|ASCII] [MAXMEM v] [MORE] [TRUST ON|OFF] [VERBOSE ON|OFF] 

[SHIFT ON|OFF] [SCALE ON|OFF] [COMMIT|ROLLBACK|RECALLTRACE] [DIR name] 

wfdisclist [filelist] [css options] [filelist]
\end{SACSTX}

css选项至少是下列之一：

\begin{SACSTX}
STATION station
CHANNEL channel
BANDWIDTH band code
ORIENTATION orientation code
\end{SACSTX}

这些选项使命令从符合相关记录内容的wfdisc文件中进行选择。

\SACTitle{输入}
\begin{description}
\item [ASCII] (默认)读取普通的文本文件
\item [BINARY] 读取二进制CSS文件。见WRITECSS了解更多信息
\item [TRUST ON|OFF] 这个选项用于判决从SAC格式转为CSS格式的模棱两可。
    当转化这数据时，比较事件ID可能意味着这些文件有用于可识别的事件信息，
    或者它们可能是合并了两个非常不同格式的数据的人工制品。
    当设置TRUST为ON时，相较于TRUSRT为OFF，SAC更可能接受比较事件ID为事件识别信息，
    依赖于和现在在内存中的数据文件相关的READ命令的历史。%翻译有疑问
\item [MAXMEM]用于设定读取数据时所需的物理内存的最大百分比。
    当达到设定的限制时，即使已经读取了其他数据库表，也不会再读取更多的波形数据。
    MAXMEN的默认值是0.3。
\item [MORE] 见READ命令。
\item [VERBOSE ON|OFF] 如果VERBOSE是ON，SAC展示关于正在读取的波形数据的延伸信息，
    并且打印出包含的CSS数据库表的概要。
    SAC也为向SAC内部格式的转化的显示一个进度指示器。
\item [SHIFT ON|OFF] 如果SHIFT是ON，发震时刻将被设置为0，其他相关时间头段变量将会做相应修改。
    一些震中距相关头段变量也会受影响。
    SHIFT ON是默认值。
\item [SCALE ON|OFF] SCALE选项默认是OFF。
    当SCALE选项是OFF时，SAC认为从.w文件读取的数据的单位是counts。
    \footnote{解释counts}
    当SCALE选项是ON时，SAC会在单位counts的基础上乘以一个比例因子。
    这个比例因子由.wfdisc文件里的校准(CALIB)给出。
    这个SCALE选项随着READ SEGY、READGSE和READSUDS的SCALE选项变化。
    如果SCALE选项是OFF，从这个文件来的CALIB值会被存入SAC的SCALE头段变量中。
    如果SCALE选项是ON，SAC的SCALE头段区域(header field)将被设置为1.0。
    SCALE是一个处理仪器响应的粗陋方法。
    更好的方式是使用TRANSFER命令。
    建议READ时，让SCALE为OFF，并且用TRANSFER命令。
    只有在TRANSFER命令需要的响应信息无法获得时，SCALE才应该为ON。
\item [COMMIT]如果MORE选项进行了设置，COMMIT选项会把头段和波形记录到SAC的内存中，
    在读取更多文件前从RAM删除之前任何版本的头段和波形。
    COMMIT是默认值。
\item [ROLLBACK] 如果设置了MORE选项，ROLLBACK选项在读取更多文件前恢复到上次记录到的头段和波形的版本。
\item [RECALLTRACE]如果设置了MORE选项，RECALLTRACE选项：

    波形回滚到上一个版本，

    这些波形紧密相关的头段变量回滚到上一个版本，

    记录那些和这些波形不紧密相关的头段变量(可用来获得哪些变量被记录了，哪些则是回滚到上一个版本)。%这一段和前面两段是前面加点的列表，该用哪个列表宏包？

    注意：如果MORE选项没有设置，COMMIT、ROLLBACK和RECALLTRACE选项就不发挥作用。%这个『注意』这样排版好吗？原文看上去像一个\item
\item [DIR name] wfdisc文件所在的路径
    \footnote{关于dir选项，有一个很大的陷阱，详见``\nameref{sec:read-dir}''。}
\item [filelist] 包含在先前的specified wfdisc(s)文件的名字列表。%这个specified wfdisc(s)的specified怎么翻译？
    这些文件会被搜索，首先搜索的是DIR选项中设定的路径，然后使用wfdisc文件中设定的路径。
    如果没有filelist，会将specified wfdisc(s)文件内指定的文件读入内存。
\item[STATION station]station是一个6个或更少字符构成的字符串。
    .wfdisc文件中那些KSTNM匹配的台站的行会被选中。
    station可以包含通配符：*和？。
\item[CHANNEL channel]channel是一个8个或更少字符构成的字符串。
    .wfdisc文件中那些channel匹配的台站的行会被选中。
    channel可以包含通配符：*和？。
%以下不是，我为了好写，是在read.tex的基础上改内容来写的
\item [XDR] 读取XDR格式的文件。此格式用于实现不同构架的二进制数据的转换
\item [ALPHA] 输入文件是SAC的字符数字型文件，该选项与XDR选项不兼容
\item [SEGY] 读取IRIS/PASSCAL定义的SEGY格式文件。该格式允许一个文件包含一个波形
\item [SCALE] 只能和SEGY选项搭配使用，该选项默认是关闭的。当SCALE选项为OFF时，
    SAC直接从SEGY文件中读取数据值；当SCALE为ON时，SAC将每个数据值乘以以文件中给定的
    SCALE因子。若SCALE为OFF，则这个文件中的SCALE值将储存在SAC头段SCALE中；若SCALE为ON，
    SAC的SCALE头段将被设置为1.0。
\item [filelist] 文件列表。可以是简单的文件名，也可以包含相对或绝对路径，也可以使用
    通配符。
\end{description}

\SACTitle{缺省值}
\begin{SACDFT}
read dir current
\end{SACDFT}

\SACTitle{说明}%说明部分已经“写好”，注意不是read旧的部分，为了排版从前面移动过来的！
2.8版本只支持wfdisc、arrival和origin。
READCSS之前的版本要求origin文件只有一行与波形有关%此句存疑
现在的版本可以用来自一个wftag文件或者wfdisc文件中an evid column的信息来提取正确的源(position 284 - 291)。%此句存疑
如果没有可用的信息，READCSS会默认以前的方式用origin文件的第一行。
现在，用READCSS读取数据不再会有数据丢失。
尽管现有的SAC命令只能获取一部分CSS数据，从CSS文本文件读取的存放在内存中的每个数据都可以用命令WRITECSS写入磁盘。

READCSS现在（可以）读取一个非标准的数据库表，名为sacdata(由WRITECSS命令输出的)。%此句存疑
比如，你现在可以用WRITECSS把频率域数据写入磁盘，然后用READCSS读取

READCSS现在有一个二进制选项，以便读取WRITECSS生成的二进制的CSS文件。
在二进制模式中，css选项没有作用。
也就是说，指定文件的全部内容都会读取。

READCSS支持如下的二进制数据格式：在大端序机器(比如Sun)上的t8、t4、f8、f4、s4、s3、s2、i4、i2、g2、e1和ri (real-imag)。

在小端序机器(比如DEC和PC)上： f8、f4、t8、t4、i4、i2、s4、s2和g2。

\nameref{cmd:cut}命令可以用于指定读取文件的一部分数据。
在2000年之后产生的SAC文件会被假定年份为四位数字。
年份为两个数字的文件被假定为20世纪，会被加上1900。

在使用read命令时，正常情况下内存中的老数据会被新读取的数据所替代。若使用more选项，则新数据
将被读入内存并放在老数据的后面。在如下三种情况下more选项可能会有用：
\begin{itemize}
\item 文件列表太长无法在一行中键入
\item 在长文件列表中某个文件名拼错而没有读入，可以使用more选项再次读入
\item 一个文件被读入，作了些处理，然后与原始数据比较
\end{itemize}

\SACTitle{示例}
read命令的简单示例位于~``\nameref{sec:read-and-write}''~一节。

如果你想要对一个数据进行高通滤波，并与原始数据进行对比：
\begin{SACCode}
SAC> r f01
SAC> hp c 1.3 n 6
SAC> r more f01
SAC> p1
\end{SACCode}

假设SAC的启动目录位于``/me/data''，你想要处理其子目录``event1''和``event2''下的文件。
\begin{SACCode}
SAC> read dir event1 f01 f02
\end{SACCode}
读取了目录``/me/data/event1''下的文件。

\begin{SACCode}
SAC> read f03 g03
\end{SACCode}
相同目录下的文件被读入。

\begin{SACCode}
SAC> read dir event2 *
\end{SACCode}
``/me/data/event2''下的全部文件被读入:

\begin{SACCode}
SAC> read dir current f03 g03
\end{SACCode}
目录``/me/data''下的文件被读入。

\SACTitle{头段变量}
e、depmin、depmax、depmen、b

\SACTitle{相关命令}
\nameref{cmd:cut}、\nameref{cmd:readerr}、\nameref{cmd:wild}
