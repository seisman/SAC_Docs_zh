\section{质量控制}

质量控制就是标记/删除信噪比低或不合适的波形。

用户可以自己在程序中判断数据的好坏以进行质量控制，但这样做很困难，因为实际情况中，
会遇到各种奇形怪状的``坏''波形，很难用统一的程序将这些``坏''波形挑选出来，所以
更多时候需要人工的参与。


我个人的做法如下：
\begin{SACCode}
SAC> r *.SAC        // 读入全部的SAC数据
SAC> ppk p 5        // plotpk，每次绘制5个波形
// 若波形质量很差，则用t9标记
SAC> wh
SAC> q
\end{SACCode}

解释一下以上做法，首先读入所有的SAC数据，然后利用~\nameref{cmd:plotpk}，
每次绘制n(如果是3分量数据，n一般取3)个波形。
若波形质量很好，则不理会；若波形质量很差，则在波形的任意时刻标记t9的值
(具体如何标记可以参考下一节的内容)，然后使用wh将标记的t9保存到头段中，再退出SAC。

完成上面的步骤之后，所有``坏''波形的t9都被标记，一般来说都是一个正值，而所有``好''波形的
t9则都处于未定义状态，其值为~\verb+t9=-12345.0+。

鉴于此，可以通过如下命令删除``坏''波形：
\begin{minted}{console}
$ saclst t9 f *.SAC | awk '$2>0 {print "rm",$1}' | sh
\end{minted}
\begin{note}
一定要在理解该命令的含义的前提下才可使用，否则可能会造成数据的丢失！
\end{note}

当然，也可以用如下命令将``坏''数据移动到专门的目录中：
\begin{minted}{console}
$ mkdir BAD
$ saclst t9 f *.SAC | awk '$2>0 {print "mv", $1, "BAD/"}' | sh
\end{minted}
\begin{note}
awk命令中，目录名BAD后最好加上斜杠。若不加斜杠，且忘记新建目录BAD，则所有应该
放在目录BAD中的文件都会被重命名为BAD，进而导致文件丢失。
\end{note}
