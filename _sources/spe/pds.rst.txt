pds
===

概要
----

用能量密度谱方法计算谱估计

语法
----

.. code-block:: console

    PDS [Seconds v|Lags n] [Number n]
        [Type HAMming|HANning|Cosine|Rectangle|Triangle]

输入
----

SECONDS v
    设置窗长为v秒

LAGS n
    设置窗长为n？

NUMBER n
    设置谱估计使用的数据点数

TYPE type
    设置要使用的窗类型

缺省值
------

.. code-block:: console

    pds type hamming

说明
----

该命令实现了传统的谱估计方法。样本相关函数首先进行相关窗截窗，生成的函数
再使用FFT获得谱估计。正如在 :doc:`/spe/cor` 命令文档中提到的，在估计偏差
（即丧失分辨率）与估计方差之间存在 tradeoff。随着窗长增加，频率域分辨率
增加，进而偏差减少；然而，样本相关函数在大延迟时值较大，谱估计的方差
也会增加，这是由于在大延迟时用于估计的数据点数变少了。

相关窗类型的选取与 :doc:`/spe/cor` 文档中描述的数据窗有不同的效果。
这是两种不同类型的偏差之间的选择。

该谱估计方法用相关窗的 Fourier 变换来逼近真实谱的卷积。窗变换由两个特性控制，
一个是控制分辨率的中心瓣，一个是控制带外能量泄露的旁瓣。通常来说，用户想要
尽可能窄的主瓣以及尽可能小的旁瓣。

大的旁瓣会在谱估计上产生一个虚假的低值，可能会掩盖高动态范围的频谱衰减。
窗类型的选取在主瓣分辨率与旁瓣能量泄露之间存在tradeoff。

矩形窗有最窄的主瓣，因此也具有最好的分辨率，同时有最大的旁瓣。
余弦窗稍微减小了旁瓣，但基本不太影响主瓣宽度。这两种窗主要用于估计
瞬变信号的谱，以获取尽可能小的时间域失真。Hamming 和 Hanning 窗则具有
很小的旁瓣和较宽的主瓣，当用户有大量数据的时候比较有用，可以通过增加
窗的尺寸来控制分辨率。Hamming 和 Hanning 窗都是余弦窗的衍生，但 Hamming 窗
经过优化以尽可能地减少最大旁瓣的尺寸，因而该命令默认使用 Hamming 窗。
三角窗也有很好的旁瓣结构，但是它有特别好的性质，即保证了谱估计总是非负值。

通常情况下，当用户需要处理大量数据时，PDS 方法要优于另外两种参数化方法。
因为在这种情况下，分辨率不受限制，并且对这种算法的了解要比对其他方法更
多一些。例如，理论上可以给出该方法的置信度和分辨率。这些指标包括在
SPE 中。参量方法通常显示出比 PDS 更好的分辨率（尤其是在估计线性谱的时候），
并且在数据量有限时更加有用。
